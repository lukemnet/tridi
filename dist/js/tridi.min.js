!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Tridi",[],e):"object"==typeof exports?exports.Tridi=e():t.Tridi=e()}(self,(function(){return(()=>{"use strict";var t={646:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.create=void 0;var i=function(){function t(t){var e=this;this.trigger=function(t){var i=e[t];i&&i()},this.validate=function(t){t.element||console.error("'element' property is missing or invalid. Container element must be specified."),void 0===t.images&&void 0===t.format&&console.error("'format' property is missing or invalid. Image format must be provided for 'numbered' property."),"numbered"!==t.images||t.location||console.error("'location' property is missing or invalid. Image location must be provided for 'numbered' property.")},this.validate(t),this.element=t.element,this.images=t.images||"numbered",this.format=t.format||void 0,this.location=t.location||"./images",this.count=Array.isArray(this.images)?this.images.length:t.count,this.draggable=void 0===t.draggable||t.draggable,this.keys=t.keys||!1,this.hintOnStartup=t.hintOnStartup||!1,this.hintText=t.hintText||null,this.focusOnHintClose=t.focusOnHintClose||!1,this.lazy=t.lazy||!1,this.autoplay=t.autoplay||!1,this.autoplaySpeed=void 0!==t.autoplaySpeed?t.autoplaySpeed:50,this.stopAutoplayOnClick=t.stopAutoplayOnClick||!1,this.stopAutoplayOnMouseenter=t.stopAutoplayOnMouseenter||!1,this.resumeAutoplayOnMouseleave=t.resumeAutoplayOnMouseleave||!1,this.resumeAutoplayDelay=t.resumeAutoplayDelay||0,this.passive=void 0===t.passive||t.passive,this.spinner=t.spinner||!1,this.touch=void 0===t.touch||t.touch,this.mousewheel=t.mousewheel||!1,this.inverse=t.inverse||!1,this.dragInterval=t.dragInterval||1,this.touchDragInterval=t.touchDragInterval||2,this.mouseleaveDetect=t.mouseleaveDetect||!1,this.onViewerGenerate=t.onViewerGenerate||void 0,this.onViewerImageGenerate=t.onViewerImageGenerate||void 0,this.onViewerImageUpdate=t.onViewerImageUpdate||void 0,this.onHintShow=t.onHintShow||void 0,this.onHintHide=t.onHintHide||void 0,this.onLoadingScreenShow=t.onLoadingScreenShow||void 0,this.onLoadingScreenHide=t.onLoadingScreenHide||void 0,this.onImagesPreload=t.onImagesPreload||void 0,this.onAutoplayStart=t.onAutoplayStart||void 0,this.onAutoplayStop=t.onAutoplayStop||void 0,this.onNextMove=t.onNextMove||void 0,this.onPrevMove=t.onPrevMove||void 0,this.onNextFrame=t.onNextFrame||void 0,this.onPrevFrame=t.onPrevFrame||void 0,this.onDragStart=t.onDragStart||void 0,this.onDragEnd=t.onDragEnd||void 0,this.onLoad=t.onLoad||void 0,this.onUpdate=t.onUpdate||void 0,this.elementName=this.setElementName(),this.imageIndex=1,this.moveBuffer=[],this.dragActive=!1,this.intervals=[],this.timeouts=[],this.stashedImgs=0}return t.prototype.setElementName=function(){var t=this.element;return"string"==typeof t?t.substr(1):t.getAttribute("id")?t.getAttribute("id"):t.getAttribute("class")?t.getAttribute("class").split(" ")[0]:"unnamedTridi-"+(Math.floor(9e4*Math.random())+1e4)},t.prototype.validateUpdate=function(t){return!!(t.images||t.format||t.count||t.location)||(console.error("UpdatableOptions object doesn't contain options that can be updated."),!1)},t.prototype.updateOptions=function(t){var e=this;Object.keys(t).map((function(i){e[i]=t[i],"images"===i&&t[i].constructor===Array&&(e.count=t.images.length)}))},t.prototype.getElem=function(t){return"string"==typeof this.element?t?document.querySelector(this.element+" "+t):document.querySelector(this.element):this.element},t.prototype.viewer=function(){return this.getElem()},t.prototype.stash=function(){return this.getElem(".tridi-stash")},t.prototype.getHintOverlay=function(){return this.getElem(".tridi-hint-overlay")},t.prototype.getLoadingScreen=function(){return this.getElem(".tridi-loading")},t.prototype.image=function(t){return this.imgs()[t-1]},t.prototype.viewerImage=function(){return this.getElem(".tridi-viewer-image")},t.prototype.lazyLoad=function(t,e){this.lazy&&!e?(this.viewerImage().addEventListener("click",t),this.touch&&this.viewerImage().addEventListener("touchstart",t,{passive:this.passive})):t()},t.prototype.imgs=function(){var t=this;return"numbered"===this.images?Array.apply(null,{length:this.count}).map((function(e,i){return t.location+"/"+(i+1)+"."+t.format.toLowerCase()})):this.images},t.prototype.generateViewer=function(){this.viewer().className+=" tridi-viewer tridi-"+this.elementName+"-viewer tridi-draggable-"+this.draggable+" tridi-touch-"+this.touch+" tridi-mousewheel-"+this.mousewheel+" tridi-hintOnStartup-"+this.hintOnStartup+" tridi-lazy-"+this.lazy,this.trigger("onViewerGenerate")},t.prototype.generateLoadingScreen=function(){var t=document.createElement("div");t.className+="tridi-loading tridi-"+this.elementName+"-loading",t.style.display="none";var e=document.createElement("div");e.className+="tridi-spinner tridi-"+this.elementName+"-spinner",t.appendChild(e),this.viewer().appendChild(t)},t.prototype.setLoadingState=function(t,e){this.getLoadingScreen().style.display=t?"block":"none",!e&&this.trigger(t?"onLoadingScreenShow":"onLoadingScreenHide")},t.prototype.generateStash=function(){if(!this.stash()){this.stashedImgs=0;var t=document.createElement("div");t.style.display="none",t.classList.add("tridi-stash"),this.viewer().appendChild(t)}},t.prototype.destroyStash=function(){this.stashedImgs=0,this.stash().parentNode.removeChild(this.stash())},t.prototype.displayHintOnStartup=function(t){var e=this;if(this.hintOnStartup){var i="tridi-"+this.elementName+"-hint-overlay",o=document.createElement("div");o.className+="tridi-hint-overlay "+i,o.tabIndex=0;var n="tridi-"+this.elementName+"-hint",s=document.createElement("div");s.className+="tridi-hint "+n,this.hintText&&(s.innerHTML='<span class="tridi-hint-text tridi-'+this.elementName+'-hint-text">'+this.hintText+"</span>"),o.appendChild(s),this.viewer().appendChild(o),this.trigger("onHintShow");var r=function(o){var s=o.target.classList.contains(i),r=o.target.classList.contains(n);(s||r)&&(e.getHintOverlay().style.display="none",t(),e.focusOnHintClose&&e.viewerImage().focus(),e.trigger("onHintHide"))};document.addEventListener("click",r),this.touch&&document.addEventListener("touchstart",r),document.addEventListener("keydown",(function(t){"Enter"===t.key&&r(t)}))}else t()},t.prototype.stashImage=function(t,e,i,o){var n=new Image;n.onload=o.bind(this),n.className+="tridi-image tridi-image-"+(i+1),n.src=e,t.innerHTML+=n.outerHTML},t.prototype.populateStash=function(){var t=this,e=this.stash(),i=this.imgs();e&&i&&i.map((function(o,n){t.stashImage(e,o,n,(function(){t.stashedImgs+=1,t.stashedImgs===i.length&&(t.setLoadingState(!1,!0),t.trigger("onImagesPreload"))}))}))},t.prototype.generateViewerImage=function(){var t=this,e=this.viewer(),i=new Image;i.onload=function(){return t.trigger("onViewerImageGenerate")},i.className+="tridi-viewer-image tridi-"+this.elementName+"-viewer-image",i.setAttribute("draggable","false"),i.setAttribute("alt",""),i.src=this.image(1),e.innerHTML=""+i.outerHTML+e.innerHTML},t.prototype.updateViewerImage=function(t){var e=this;this.viewerImage().onload=function(){return e.trigger("onViewerImageUpdate")},this.viewerImage().src=this.image(t)},t.prototype.nextFrame=function(){this.imageIndex=this.imageIndex<=1?this.count:this.imageIndex-1,this.viewerImage().src=this.image(this.imageIndex),this.trigger("onNextFrame")},t.prototype.prevFrame=function(){this.imageIndex=this.imageIndex>=this.count?1:this.imageIndex+1,this.viewerImage().src=this.image(this.imageIndex),this.trigger("onPrevFrame")},t.prototype.nextMove=function(){return this.trigger("onNextMove"),this.inverse?this.prevFrame():this.nextFrame()},t.prototype.prevMove=function(){return this.trigger("onPrevMove"),this.inverse?this.nextFrame():this.prevFrame()},t.prototype.rotateViewerImage=function(t){var e=t.touches?this.touchDragInterval:this.dragInterval,i=t.touches?t.touches[0].clientX:t.clientX,o=Math.floor(i)-this.viewerImage().offsetLeft;if(this.moveBuffer.length<2)this.moveBuffer.push(o);else{var n=this.moveBuffer[1];this.moveBuffer[1]=o,this.moveBuffer[0]=n}var s=o%e==0,r=this.moveBuffer[0],a=this.moveBuffer[1];s&&a<r?this.nextMove():s&&a>r&&this.prevMove()},t.prototype.startDragging=function(){this.dragActive=!0,this.viewer().classList.add("tridi-dragging"),this.trigger("onDragStart")},t.prototype.stopDragging=function(){this.dragActive=!1,this.viewer().classList.remove("tridi-dragging"),this.trigger("onDragEnd")},t.prototype.resetMoveBuffer=function(){this.moveBuffer=[]},t.prototype.attachCosmeticEvents=function(){var t=this.viewer();t.addEventListener("mouseenter",(function(){return t.classList.add("tridi-viewer-hovered")})),t.addEventListener("mouseleave",(function(){return t.classList.remove("tridi-viewer-hovered")}))},t.prototype.attachDragEvents=function(){var t=this;if(this.draggable){var e=this.viewerImage();e.addEventListener("mousedown",(function(e){e.preventDefault&&e.preventDefault(),t.startDragging(),t.rotateViewerImage(e)})),e.addEventListener("mouseup",(function(e){e.preventDefault&&e.preventDefault(),t.stopDragging(),t.resetMoveBuffer()})),e.addEventListener("mousemove",(function(e){t.dragActive&&t.rotateViewerImage(e)})),e.addEventListener("mouseleave",(function(){t.resetMoveBuffer()}))}},t.prototype.attachMouseLeaveDetection=function(){var t=this;this.mouseleaveDetect&&this.viewer().addEventListener("mouseleave",(function(){t.stopDragging(),t.resetMoveBuffer()}))},t.prototype.attachTouchEvents=function(){var t=this;if(this.touch){var e=this.viewerImage();e.addEventListener("touchstart",(function(e){t.startDragging(),t.rotateViewerImage(e)}),{passive:!0}),e.addEventListener("touchmove",(function(e){t.rotateViewerImage(e)}),{passive:!0}),e.addEventListener("touchend",(function(){t.stopDragging(),t.resetMoveBuffer()}))}},t.prototype.attachMousewheelEvents=function(){var t=this;this.mousewheel&&this.viewerImage().addEventListener("wheel",(function(e){e.preventDefault&&!t.passive&&e.preventDefault(),e.deltaY/120>0?t.nextMove():t.prevMove()}),{passive:this.passive})},t.prototype.attachKeyEvents=function(){var t=this;this.keys&&(this.viewerImage().setAttribute("tabindex","0"),this.viewerImage().addEventListener("keydown",(function(e){"ArrowLeft"===e.key&&t.prevMove(),"ArrowRight"===e.key&&t.nextMove()})))},t.prototype.clearIntervals=function(){this.intervals.map(clearInterval),this.intervals.length=0},t.prototype.setAutoplayInterval=function(){var t=window.setInterval(this.nextMove.bind(this),this.autoplaySpeed);this.intervals.push(t)},t.prototype.clearTimeouts=function(){this.timeouts.map(clearTimeout),this.timeouts.length=0},t.prototype.setAutoplayTimeout=function(){var t=window.setTimeout(this.setAutoplayInterval.bind(this),this.resumeAutoplayDelay);this.timeouts.push(t)},t.prototype.toggleAutoplay=function(t,e){t?(this.clearTimeouts(),0===this.intervals.length&&(e?this.setAutoplayInterval():this.setAutoplayTimeout())):this.clearIntervals(),this.trigger(t?"onAutoplayStart":"onAutoplayStop")},t.prototype.stopAutoplaySequence=function(){this.clearTimeouts(),this.toggleAutoplay(!1)},t.prototype.startAutoplay=function(){var t=this;if(this.autoplay){this.toggleAutoplay(!0,!0),this.stopAutoplayOnClick&&(this.viewerImage().addEventListener("mousedown",this.stopAutoplaySequence.bind(this)),this.touch&&this.viewerImage().addEventListener("touchstart",this.stopAutoplaySequence.bind(this),{passive:this.passive})),this.stopAutoplayOnMouseenter&&this.viewerImage().addEventListener("mouseenter",this.stopAutoplaySequence.bind(this));var e=function(e){!e.target.classList.contains("tridi-btn")&&t.toggleAutoplay(!0)};if(this.resumeAutoplayOnMouseleave){var i=this.viewerImage();i.addEventListener("mouseleave",e),this.touch&&i.addEventListener("touchend",e)}}},t.prototype.attachEvents=function(){this.attachCosmeticEvents(),this.attachDragEvents(),this.attachMouseLeaveDetection(),this.attachTouchEvents(),this.attachMousewheelEvents(),this.attachKeyEvents()},t.prototype.start=function(){var t=this;this.generateViewer(),this.generateLoadingScreen(),this.setLoadingState(!0),this.generateViewerImage(),this.setLoadingState(!1),this.displayHintOnStartup((function(){t.lazyLoad((function(){t.setLoadingState(!0),t.generateStash(),t.populateStash(),t.attachEvents(),t.startAutoplay(),t.setLoadingState(!1)}))})),this.trigger("onLoad")},t.prototype.next=function(){this.nextMove()},t.prototype.prev=function(){this.prevMove()},t.prototype.autoplayStart=function(){this.toggleAutoplay(!0)},t.prototype.autoplayStop=function(){this.toggleAutoplay(!1)},t.prototype.update=function(t,e){this.validateUpdate(t)&&(this.setLoadingState(!0),this.updateOptions(t),this.destroyStash(),this.generateStash(),this.populateStash(),this.updateViewerImage(e?this.imageIndex:1),this.attachEvents(),this.setLoadingState(!1),this.trigger("onUpdate"))},t.prototype.load=function(){this.start()},t}();e.create=function(t){return new i(t)}}},e={};return function i(o){if(e[o])return e[o].exports;var n=e[o]={exports:{}};return t[o](n,n.exports,i),n.exports}(646)})()}));
//# sourceMappingURL=tridi.min.js.map